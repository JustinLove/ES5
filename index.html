<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" 
                    "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
  <link rel="stylesheet" href="qunit/qunit.css" type="text/css" media="screen" />
<script type="text/javascript" src="qunit/qunit.js"></script>

<script type="text/javascript" src="es5.js"></script>

  <script>

var es5 = exports;

test("got a module", function() {
  ok(es5);
});

function throwsTypeError(o, f, args) {
  test(f + " only accepts objects", function() {
    try {
      o[f].apply(o, args);
      ok(false, "should have thrown TypeError");
    } catch (e) {
      ok(e instanceof TypeError, "caught TypeError");
    }
  });
}

function stub(o, f) {
  throwsTypeError(o, f, [1]);
  var x = {};
  test(f + " stubbed", function() {
    equals(o[f].apply(o, [x]), x);
  });
}

function queryStub(o, f, result) {
  throwsTypeError(o, f, [1]);
  test(f + " stubbed", function() {
    equals(o[f].apply(o, [x]), result);
  });
}

function testPropertyDescriptor(desc, value, prefix) {
  expect(0);

  test(prefix + " truthy", function() {
    ok(desc);
  });

  test(prefix + " value property", function() {
    equals(desc.value, 1);
  });

  test(prefix + " writeable property", function() {
    equals(desc.writeable, true);
  });

  test(prefix + " enumerable property", function() {
    equals(desc.enumerable, true);
  });

  test(prefix + " configurable property", function() {
    equals(desc.configurable, true);
  });
}

module("Object");
test("Object", function() {
  ok(es5.Object);

  throwsTypeError(es5.Object, 'getPrototypeOf', [1]);

  test("getPrototypeOf", function() {
    equals(es5.Object.getPrototypeOf({}), Object.prototype);
  });

  throwsTypeError(es5.Object, 'getOwnPropertyDescriptor', [1]);

  test("getOwnPropertyDescriptor", function() {
    var x = {a: 1, b: 2};
    var a = es5.Object.getOwnPropertyDescriptor(x, 'a');
    testPropertyDescriptor(a, 1, 'getOwnPropertyDescriptor');
  });

  throwsTypeError(es5.Object, 'getOwnPropertyNames', [1]);

  test("getOwnPropertyNames", function() {
    var F = function(){};
    F.prototype = {z:26};
    var x = new F();
    x.a = 1;
    x.b = 2;

    var names = es5.Object.getOwnPropertyNames(x);
    same(names, ['a', 'b']);
  });

  throwsTypeError(es5.Object, 'create', [1]);

  test("create with null", function() {
    ok(es5.Object.create());
  });

  test("create with an object", function() {
    var x = {};
    var y = es5.Object.create(x);
    ok(x === es5.Object.getPrototypeOf(y), "Prototype match");
  });

  test("create with properties", function() {
    var x = es5.Object.create(null, {a: {value: 1}});
    equals(x.a, 1);
  });

  throwsTypeError(es5.Object, 'defineProperty', [1]);

  test("defineProperty", function() {
    var x = {};
    es5.Object.defineProperty(x, 'a', {value: 1});
    equals(x.a, 1);
  });

  test("defineProperty returns the object", function() {
    var x = {};
    equals(es5.Object.defineProperty(x, 'a'), x);
  });

  throwsTypeError(es5.Object, 'defineProperties', [1]);

  test("defineProperties", function() {
    expect(2);
    x = {};
    es5.Object.defineProperties(x, {a: {value: 1}, b: {value: 2}});
    equals(x.a, 1);
    equals(x.b, 2);
  });

  test("defineProperties returns the object", function() {
    var x = {};
    equals(es5.Object.defineProperties(x, {a: {}}), x);
  });

  stub(es5.Object, 'seal');
  stub(es5.Object, 'freeze');
  stub(es5.Object, 'preventExtensions');

  queryStub(es5.Object, 'isSealed', false);
  queryStub(es5.Object, 'isFrozen', false);
  queryStub(es5.Object, 'isExtensible', true);

  throwsTypeError(es5.Object, 'keys', [1]);

  test("keys", function() {
    var F = function(){};
    F.prototype = {z:26};
    var x = new F();
    x.a = 1;
    x.b = 2;

    var names = es5.Object.keys(x);
    same(names, ['a', 'b', 'z']);
  });
});


  </script>
  
</head>
<body>
 <h1 id="qunit-header">EcmaScript 5 in 3</h1>
 <h2 id="qunit-banner"></h2>
 <h2 id="qunit-userAgent"></h2>
 <ol id="qunit-tests"></ol>
</body>
</html>
</html>